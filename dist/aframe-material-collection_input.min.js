!function(t){var e={};function i(s){if(e[s])return e[s].exports;var h=e[s]={i:s,l:!1,exports:{}};return t[s].call(h.exports,h,h.exports,i),h.l=!0,h.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var h in t)i.d(s,h,function(e){return t[e]}.bind(null,h));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=59)}({12:function(t,e){t.exports=AFRAME.registerComponent("ui-input-text",{depends:["text"],schema:{value:{default:""},disabled:{type:"boolean",default:!1},type:{default:"text"},cameraEl:{type:"selector"},rigEl:{type:"selector"},tabNext:{type:"selector"},width:{type:"number",default:1},height:{type:"number",default:.2},backgroundColor:{default:"white"},lookControlsComponent:{default:"look-controls"},wasdControlsComponent:{default:"wasd-controls"},placeHolder:{default:"Text..."}},init(){this.setupElements(),this.setupScrollClips(),this.text.addEventListener("textfontset",()=>{this.text.selectionStart=0,this.text.selectionLength=0,this.startSelection=0,this.scrollOffset=0,this.alphabet={},this.scrollIndex=0;let t=this.data.value.split("");this.chars=[],this.charsAllowed=["-","_","+","=","{","}","[","]",":",";","'","@","~","#","<",">",",",".","?","/","|","\\","`","Â¬"];for(let e=0;e<t.length;e++)this.chars.push({char:t[e]});this.blurHandler=(()=>{this.el.sceneEl.defaultKeypressPrevented?this.el.sceneEl.defaultKeypressPrevented=!1:this.blur()}),this.isMoving=!1,this.mousemove=this.onMousemove.bind(this),this.keydown=(t=>this.handleKeyboardEvent(t)),this.keySelectAll=(()=>this.selectAll()),this.keyCut=(()=>this.cutText()),this.keyCopy=(()=>this.copyText()),this.keyPaste=(()=>this.pasteText()),this.backing.addEventListener("mousedown",()=>{this.focus()}),this.el.sceneEl.addEventListener("mouseup",()=>{this.backing.removeEventListener("ui-mousemove",this.mousemove),this.isMoving=!1,this.setSelection(this.text.selectionStart,this.text.selectionLength)}),this.el.setAttribute("visible",!1),this.setValue(),setTimeout(()=>{this.setScrollClips(),this.el.setAttribute("visible",!0)},200)}),this.el.getValue=this.getValue.bind(this),this.el.value=this.value.bind(this),this.el.focus=this.focus.bind(this)},setupScrollClips(){this.content_clips=[new THREE.Plane(new THREE.Vector3(-1,0,0),0),new THREE.Plane(new THREE.Vector3(1,0,0),0)]},selectAll(){this.text.selectionStart=0,this.text.selectionLength=this.chars.length,this.setValue()},increaseWrap(){let t=this.text.object3D.children[this.text.object3D.children.length-1];t&&(t.geometry.layout&&t.geometry.layout._linesTotal>1?(this.text.setAttribute("visible",!1),this.text.setAttribute("width",1.2*this.text.getAttribute("width")),this.text.setAttribute("wrap-pixels",500*this.text.getAttribute("width")),this.text.setAttribute("x-offset",(this.text.getAttribute("width")-this.data.width)/2),setTimeout(()=>this.increaseWrap())):this.text.setAttribute("visible",!0))},setScrollClips(){this.content_clips[0].set(new THREE.Vector3(-1,0,0),this.data.width/2+.005),this.content_clips[1].set(new THREE.Vector3(1,0,0),this.data.width/2+.005),this.content_clips[0].applyMatrix4(this.backing.object3D.matrixWorld),this.content_clips[1].applyMatrix4(this.backing.object3D.matrixWorld),setTimeout(()=>{let t=this.text.object3D.children[this.text.object3D.children.length-1];t&&(t.material.clippingPlanes=this.text._content_clips?this.text._content_clips.concat(this.content_clips):this.content_clips)},0);let t=this.selectionHighlight.getObject3D("mesh");t&&(t.material.clippingPlanes=this.text._content_clips?this.text._content_clips.concat(this.content_clips):this.content_clips);let e=this.carret.getObject3D("mesh");e&&(e.material.clipShadows=!0,e.material.needsUpdate=!0,e.material.clippingPlanes=this.text._content_clips?this.text._content_clips.concat(this.content_clips):this.content_clips)},numberOnly(t,e){if(-1!==[46,8,9,27,13,110].indexOf(t.keyCode)||65===t.keyCode&&(!0===t.ctrlKey||!0===t.metaKey)||67===t.keyCode&&(!0===t.ctrlKey||!0===t.metaKey)||88===t.keyCode&&(!0===t.ctrlKey||!0===t.metaKey)||t.keyCode>=35&&t.keyCode<=39)return!0;let i=this.getValue();return t?(e?/^\d*((\.)|(\.\d+))?$/g:/^\d*?$/g).test(i+t.key):void 0},floatOnly(t){return this.numberOnly(t,!0)},focus(){this.isFocused||(this.isFocused=!0,this.setupCarret(),this.setScrollClips(),setTimeout(()=>{this.setValue(),this.el.sceneEl.addEventListener("mousedown",this.blurHandler),this.playPauseCamera("pause")}),this.backing.addEventListener("ui-mousemove",this.mousemove),window.addEventListener("keydown",this.keydown),this.el.sceneEl.addEventListener("key-select",this.keySelectAll),this.el.sceneEl.addEventListener("key-cut",this.keyCut),this.el.sceneEl.addEventListener("key-copy",this.keyCopy),this.el.sceneEl.addEventListener("key-paste",this.keyPaste),this.underline.setAttribute("height",.008),this.underline.setAttribute("color","#009688"))},blur(){this.chars.length&&"."===this.chars[this.chars.length-1].char&&"number"===this.data.type&&(this.chars.pop(),this.setValue()),this.setSelection(0,0),setTimeout(()=>{clearInterval(this.carretInterval),this.carret.getObject3D("mesh").material.opacity=0,this.isFocused=!1}),this.el.sceneEl.removeEventListener("mousedown",this.blurHandler),this.playPauseCamera("play"),window.removeEventListener("keydown",this.keydown),this.el.sceneEl.removeEventListener("key-select",this.keySelectAll),this.el.sceneEl.removeEventListener("key-cut",this.keyCut),this.el.sceneEl.removeEventListener("key-copy",this.keyCopy),this.el.sceneEl.removeEventListener("key-paste",this.keyPaste),UI.utils.stoppedChanging(this.text.object3D.uuid),this.underline.setAttribute("height",.005),this.underline.setAttribute("color","#bfbfbf")},pasteText(){navigator.clipboard.readText().then(t=>{let e=[this.text.selectionStart,this.text.selectionLength].concat(t.split("").map(t=>({char:t})));Array.prototype.splice.apply(this.chars,e),this.text.selectionStart=this.text.selectionStart+e.length-2,this.text.selectionLength=0,this.setValue()})},cutText(){this.copyText(),this.chars.splice(this.text.selectionStart,this.text.selectionLength),this.setValue()},copyText(){let t=this.chars.slice(this.text.selectionStart,this.text.selectionStart+this.text.selectionLength).map(t=>t.char).join("");navigator.clipboard.writeText(t)},handleKeyboardEvent(t){if(13===t.keyCode)this.el.emit("submit");else if(9===t.keyCode)this.data.tabNext&&(this.carret.getObject3D("mesh").material.opacity=1,this.blur(),setTimeout(()=>this.data.tabNext.focus()));else if(88===t.keyCode&&t.ctrlKey)this.cutText();else if(67===t.keyCode&&t.ctrlKey)this.copyText();else if(86===t.keyCode&&t.ctrlKey)this.pasteText();else if(65===t.keyCode&&t.ctrlKey)this.text.selectionStart=0,this.text.selectionLength=this.chars.length,t.preventDefault(),t.stopPropagation();else if(t.code.indexOf("Key")>-1||t.code.indexOf("Digit")>-1||this.charsAllowed.indexOf(t.key)>-1){let e=!0;switch(this.data.type){case"number":e=this.floatOnly(t);break;case"int":console.log(this.numberOnly(t)),e=this.numberOnly(t)}e&&(this.chars.splice(this.text.selectionStart,this.text.selectionLength,{char:t.key}),this.text.selectionStart++,this.text.selectionLength=0),t.preventDefault(),t.stopPropagation()}else 46===t.keyCode?(this.chars.splice(this.text.selectionStart,this.text.selectionLength||1),this.text.selectionStart=this.text.selectionStart>this.chars.length?this.chars.length:this.text.selectionStart,this.text.selectionLength=0,t.preventDefault(),t.stopPropagation()):39===t.keyCode?(t.shiftKey?(this.shiftStartPos||(this.shiftStartPos=this.text.selectionStart),this.text.selectionStart<this.shiftStartPos?(this.text.selectionStart++,this.text.selectionLength=Math.abs(this.shiftStartPos-this.text.selectionStart)):this.text.selectionLength++):(this.text.selectionLength?this.text.selectionStart+=this.text.selectionLength:this.text.selectionStart++,this.text.selectionLength=0,this.text.selectionStart>this.chars.length&&(this.text.selectionStart=this.chars.length),delete this.shiftStartPos),t.preventDefault(),t.stopPropagation()):37===t.keyCode?(t.shiftKey?(this.shiftStartPos||(this.shiftStartPos=this.text.selectionStart),this.text.selectionStart+this.text.selectionLength>this.shiftStartPos?this.text.selectionLength--:(this.text.selectionStart--,this.text.selectionLength=Math.abs(this.shiftStartPos-this.text.selectionStart))):(this.text.selectionLength||this.text.selectionStart--,this.text.selectionLength=0,this.text.selectionStart<0&&(this.text.selectionStart=0),delete this.shiftStartPos),t.preventDefault(),t.stopPropagation()):(this.text.selectionLength?8===t.keyCode&&(this.chars.splice(this.text.selectionStart,this.text.selectionLength),this.text.selectionLength=0):8===t.keyCode?this.text.selectionStart&&(this.chars.splice(this.text.selectionStart-1,this.text.selectionLength||1),this.text.selectionStart=this.text.selectionStart-1):32===t.keyCode&&(this.chars.splice(this.text.selectionStart,0,{char:" "}),this.text.selectionStart++),t.preventDefault(),t.stopPropagation());this.el.emit("ui-keypress",t),this.setValue(),this.carret.getObject3D("mesh").material.opacity=1},setValue(){this.setScrolledValue(),setTimeout(()=>{this.setCharacters(),this.setSelection(this.text.selectionStart,this.text.selectionLength),this.increaseWrap()})},setScrolledValue(){let t=this.getValue();this.text.setAttribute("value",t),this.chars.length?(this.text.setAttribute("value",t),this.text.setAttribute("color","#2f2f2f")):(this.text.setAttribute("color","#bfbfbf"),this.text.setAttribute("value",this.data.placeHolder))},onMousemove(t){let e=this.getSelectionPosition(t);this.isMoving||(this.isMoving=!0,this.startSelection=e);let i=this.getNearestGlyph(this.startSelection,e);this.selectionHighlight.setAttribute("scale",i.end-i.start+" 1 1"),this.selectionHighlight.setAttribute("position",i.start+(i.end-i.start)/2+" 0 0.0005"),this.carret.setAttribute("position",i.end+" 0 0.001")},setupElements(){this.container=document.createElement("a-entity"),this.container.setAttribute("position",this.data.width/2+" 0 0"),this.text=document.createElement("a-text"),this.text.setAttribute("color","#2f2f2f"),this.text.setAttribute("anchor","center"),this.text.setAttribute("align","left"),this.text.setAttribute("position","0 0 0.003"),this.text.setAttribute("width",this.data.width),this.text.setAttribute("wrap-pixels",500*this.data.width),this.text.className="no-yoga-layout",this.text.setAttribute("height",this.data.height),this.text.setAttribute("value",this.data.value),this.container.appendChild(this.text),this.selectionHighlight=document.createElement("a-box"),this.selectionHighlight.setAttribute("width",1),this.selectionHighlight.setAttribute("scale","0 1 1"),this.selectionHighlight.setAttribute("height",.16),this.selectionHighlight.setAttribute("depth",1e-5),this.selectionHighlight.setAttribute("transparent",!0),this.selectionHighlight.className="no-yoga-layout",this.selectionHighlight.setAttribute("color","#009688"),this.selectionHighlight.setAttribute("shader","flat"),this.selectionHighlight.setAttribute("opacity",.3),this.selectionHighlight.setAttribute("position","0 0 0.0005"),this.text.appendChild(this.selectionHighlight),this.carret=document.createElement("a-box"),this.carret.setAttribute("width",.01),this.carret.setAttribute("height",.12),this.carret.setAttribute("depth",1e-5),this.carret.setAttribute("transparent",!0),this.carret.setAttribute("opacity",0),this.carret.setAttribute("shader","flat"),this.carret.className="no-yoga-layout",this.carret.setAttribute("color","#009688"),this.carret.setAttribute("position",-this.data.width/2+" 0 0.001"),this.text.appendChild(this.carret),this.backing=document.createElement("a-box"),this.backing.className="intersectable no-yoga-layout text-backing",this.backing.setAttribute("width",this.data.width+.1),this.backing.setAttribute("height",this.data.height),this.backing.setAttribute("depth",1e-5),this.backing.setAttribute("color",this.data.backgroundColor),this.backing.setAttribute("shader","flat"),this.container.appendChild(this.backing),this.underline=document.createElement("a-box"),this.underline.setAttribute("width",this.data.width),this.underline.setAttribute("height",.005),this.underline.setAttribute("depth",1e-5),this.underline.className="no-yoga-layout",this.underline.setAttribute("shader","flat"),this.underline.setAttribute("color","#bfbfbf"),this.underline.setAttribute("position","0 -0.072 0.001"),this.container.appendChild(this.underline),this.el.appendChild(this.container)},setupCarret(){let t=this.carret.getObject3D("mesh").material;this.carretInterval=setInterval(()=>{t.opacity=t.opacity?0:1,UI.utils.isChanging(this.el.sceneEl,this.text.object3D.uuid)},350)},value(t){if(!t&&""!==t)return this.chars.map(t=>t.char).join("");this.chars=t.split("").map(t=>({char:t})),this.text.selectionStart=this.chars.length,this.setValue()},getValue(){let t="";for(let e=0;e<this.chars.length;e++)t+="password"===this.data.type?"*":this.chars[e].char;return t},getSelectionPosition(t){return this.el.object3D.updateMatrixWorld(),this.text.object3D.worldToLocal(t.detail.intersection.point.clone()).x},playPauseCamera(t){let e=this.data.cameraEl;e&&e.components[this.data.lookControlsComponent]&&e.components[this.data.lookControlsComponent][t](),this.data.rigEl&&(e=this.data.rigEl),e&&e.components[this.data.wasdControlsComponent]&&e.components[this.data.wasdControlsComponent][t]()},setCharacters(){this.positions=[];let t=this.text.object3D.children[this.text.object3D.children.length-1];if(!this.chars.length||!t)return;let e=t.geometry.layout.glyphs,i=t.scale.x,s=0;for(let t=0;t<e.length;t++){let h=e[t];this.chars[t]||console.log(e.length,this.chars.length);let l=" "===this.chars[t].char?20:h.data.width,n=(h.position[0]+l+h.position[1])*i+.08;0===t&&(s=(h.position[0]+h.position[1])*i+.08),this.chars[t].id||(this.chars[t].id=h.data.id,this.chars[t].width=n-s),this.chars[t].left=s,s=n}},getNearestGlyph(t,e){let i=Number(this.text.getAttribute("width")),s=this.data.width;if(e<t){let i=e;e=t,t=i}t<-s/2&&(t=-s/2),e>i-s/2&&(e=i-s/2);let h=Number.POSITIVE_INFINITY,l=Number.POSITIVE_INFINITY,n={start:0,end:0};if(this.chars.length)for(let i=0;i<=this.chars.length;i++){let r=this.chars[i===this.chars.length?i-1:i],a=(i===this.chars.length?r.left+r.width:r.left)-s/2;Math.abs(t-a)<h&&(h=Math.abs(t-a),n.start=a,this.text.selectionStart=i),Math.abs(e-a)<l&&(l=Math.abs(e-a),n.end=a,this.text.selectionLength=i-this.text.selectionStart)}return n},setSelection(t,e){this.text.selectionStart=t,this.text.selectionLength=e;let i=0,s=0;for(let h=0;h<this.chars.length;h++){let l=this.chars[h];if(h>=t&&h<t+e+1){let e=l.left;h===t&&(s=e),i=e}}let h=this.chars.length?this.chars[this.chars.length-1].left+this.chars[this.chars.length-1].width:0;t+e===this.chars.length&&(i=h),t===this.chars.length&&(s=i=h);let l=this.data.width;this.selectionHighlight.setAttribute("scale",i-s+" 1 1"),this.selectionHighlight.setAttribute("position",s+(i-s)/2-l/2+" 0 0.0005");let n=i-l/2;this.carret.setAttribute("position",n+" 0 0.001"),n>l/2-this.scrollOffset&&(this.scrollOffset=-(n-l/2),this.text.setAttribute("position",this.scrollOffset+" 0 0.003")),n+l/2<-this.scrollOffset&&(this.scrollOffset+=-this.scrollOffset-(n+l/2),this.scrollOffset>0&&(this.scrollOffset=0),this.text.setAttribute("position",this.scrollOffset+" 0 0.003"))},updateSchema(){}})},59:function(t,e,i){"use strict";i.r(e);i(12),i(9)},9:function(t,e){t.exports=AFRAME.registerPrimitive("a-ui-input-text",AFRAME.utils.extendDeep({},AFRAME.primitives.getMeshMixin(),{defaultComponents:{"ui-input-text":{placeHolder:"Text...",width:1,height:.2,value:""},"ui-double-click":{}},mappings:{width:"ui-input-text.width",height:"ui-input-text.height",type:"ui-input-text.type",value:"ui-input-text.value","background-color":"ui-input-text.backgroundColor","place-holder":"ui-input-text.placeHolder","camera-el":"ui-input-text.cameraEl","rig-el":"ui-input-text.rigEl","tab-next":"ui-input-text.tabNext","look-controls-component":"ui-input-text.lookControlsComponent","wasd-controls-component":"ui-input-text.wasdControlsComponent"}}))}});